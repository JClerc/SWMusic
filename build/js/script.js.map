{"version":3,"sources":["script.js","ambientlight.js","app.js","audio.polyfill.js","canvas.polyfill.js","episode-template.js","episode1.js","episode2.js","hyperspace.js","loader.js","navigation.js","selection.js","vote.js","main.js"],"names":["AmbientLight","video","ambient","this","light1","$","light2","interval","App","document","querySelector","bind","$$","querySelectorAll","identifier","gotoUp","current","next","direction","Error","currentName","getAttribute","call","classList","remove","add","addEventListener","animationend","e","removeEventListener","setLocation","home","window","location","href","substring","indexOf","reload","isChangingHash","hash","setTimeout","gotoHash","homeFallback","length","page","contains","HYPERSPACE","callbacks","state","i","callback","push","AudioContext","webkitAudioContext","mozAudioContext","lastTime","vendors","x","requestAnimationFrame","cancelAnimationFrame","element","currTime","Date","getTime","timeToCall","Math","max","id","clearTimeout","prototype","play","self","setInterval","applyTo","children","canvas","createElement","getContext","width","height","appendChild","drawImage","toggle","stop","clearInterval","ambientLight","pause","episodeIsPlaying","innerWidth","innerHeight","audioContext","sourceNode","analyserNode","javascriptNode","amplitudeArray","frequencyArray","context","frequency","amplitudeCount","frequencyCount","audioData","audioPlaying","sampleSize","audioUrl","middleWidth","middleHeight","lastDraw","energyInterval","averageVolume","sinOffset","PI","setupAudioNodes","createBufferSource","createAnalyser","createScriptProcessor","Uint8Array","frequencyBinCount","connect","destination","loadSound","url","request","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","buffer","playSound","onError","send","start","loop","console","warn","getAverageVolume","array","average","values","strokeStyle","shadowBlur","shadowColor","drawEnergy","lineWidth","k","amplitudeLength","amplitudeOffset","amplitudeDraw","size","beginPath","moveTo","lineTo","random","stroke","drawSound","clearCanvas","value","frenquencyLength","frenquencyOffset","frequencyDraw","sin","cos","clearRect","ex","currentTime","now","getByteTimeDomainData","getByteFrequencyData","canvasEnergy","energyCtx","energyWidth","energyHeight","particles","render","circles","initialized","init","config","count","circleMaxWidth","circlesEl","getElementById","node","style","renderFrame","frequencyData","color_gradient","increment_value","opacity","opacity_value","circle","cssText","backgroundColor","isInitialized","create_particle","particle","y","speed","radius","draw","fillStyle","arc","fill","drawing","GLOBAL_SPEED","HYPERSPACE_RUN","select","starsCount","stars","createStar","randomX","randomY","color","xs","ys","s","lineCap","preloadImages","urls","img","Image","src","loader","begin","bindNavigation","preventDefault","elements","lastMove","leftOffset","screen","rightOffset","screenScale","selectCards","percentDivisor","selectionListener","event","percent","screenX","transform","buttons","bindVote","elt","innerHTML","log"],"mappings":"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","file":"script.js","sourcesContent":["'use strict';\n\n/**\r\n * Create App object\r\n *\r\n */\n\nvar App = {},\n    $ = document.querySelector.bind(document),\n    $$ = document.querySelectorAll.bind(document);\n\n(function () {\n\n    App.goto = function (identifier, gotoUp) {\n        var current = $('section.visible'),\n            next = $('.page.' + identifier),\n            direction = gotoUp ? 'up' : 'down';\n\n        if (!next || typeof gotoUp !== 'boolean') {\n            throw new Error('Wrong arguments: ' + next + ', ' + gotoUp);\n        } else if (current == next) {\n            throw new Error('Moving to the same page..');\n        } else {\n            if (current) {\n                var currentName = current.getAttribute('data-page');\n                App.call(currentName, 'unloading');\n                current.classList.remove('visible');\n                current.classList.add('exit-' + direction);\n                current.addEventListener('animationend', function animationend(e) {\n                    App.call(currentName, 'unloaded');\n                    current.removeEventListener('animationend', animationend);\n                    current.classList.remove('exit-' + direction);\n                });\n            }\n            App.call(identifier, 'loading');\n            next.classList.add('visible');\n            next.classList.add('enter-' + direction);\n            next.addEventListener('animationend', function animationend(e) {\n                App.call(identifier, 'loaded');\n                next.removeEventListener('animationend', animationend);\n                next.classList.remove('enter-' + direction);\n                if (identifier !== 'home') {\n                    App.setLocation(identifier);\n                }\n            });\n        }\n    };\n\n    App.home = function () {\n        // Rerun the page to restart the canvas\n        if (window.location.href) {\n            window.location.href = window.location.href.substring(0, window.location.href.indexOf('#') - 1);\n        } else {\n            window.location.reload();\n        }\n    };\n\n    var isChangingHash = false;\n\n    App.setLocation = function (hash) {\n        isChangingHash = true;\n        window.location.hash = '#/' + hash;\n        setTimeout(function () {\n            isChangingHash = false;\n        }, 1);\n    };\n\n    App.gotoHash = function (homeFallback) {\n        if (isChangingHash) return;\n        if (window.location.hash && window.location.hash.length > 2) {\n            var hash = window.location.hash.substring(2),\n                page = $('.page.' + hash);\n\n            if (hash === 'home') {\n                App.home();\n                return;\n            } else if (page && page.classList.contains('page')) {\n                var current = $('section.visible');\n                if (current) {\n                    current.classList.remove('visible');\n                    var currentName = current.getAttribute('data-page');\n                    App.call(currentName, 'unloading');\n                    App.call(currentName, 'unloaded');\n                }\n                page.classList.add('visible');\n                App.call(hash, 'loading');\n                App.call(hash, 'loaded');\n                window.HYPERSPACE = false;\n                return;\n            }\n        }\n        if (homeFallback) {\n            App.home();\n        }\n    };\n\n    var callbacks = {};\n\n    App.call = function (page, state) {\n        if (callbacks[page] && callbacks[page][state]) {\n            for (var i = callbacks[page][state].length - 1; i >= 0; i--) {\n                callbacks[page][state][i]();\n            }\n        }\n    };\n\n    App.bind = function (page, state, callback) {\n        if (!callbacks[page]) {\n            callbacks[page] = {};\n        }\n        if (!callbacks[page][state]) {\n            callbacks[page][state] = [];\n        }\n        callbacks[page][state].push(callback);\n    };\n})();\n\"use strict\";\n\nwindow.AudioContext = (function () {\n    return window.AudioContext || window.webkitAudioContext || window.mozAudioContext;\n})();\n'use strict';\n\n/* Compatible avec tous les navigateurs */\n(function () {\n    var lastTime = 0;\n    var vendors = ['webkit', 'moz'];\n    for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n        window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];\n    }\n\n    if (!window.requestAnimationFrame) window.requestAnimationFrame = function (callback, element) {\n        var currTime = new Date().getTime();\n        var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n        var id = window.setTimeout(function () {\n            callback(currTime + timeToCall);\n        }, timeToCall);\n        lastTime = currTime + timeToCall;\n        return id;\n    };\n\n    if (!window.cancelAnimationFrame) window.cancelAnimationFrame = function (id) {\n        clearTimeout(id);\n    };\n})();\n'use strict';\n\nfunction AmbientLight(video, ambient) {\n    this.video = video;\n    this.ambient = ambient;\n    this.light1 = $('.light-1', ambient);\n    this.light2 = $('.light-2', ambient);\n    this.interval = -1;\n}\n\nAmbientLight.prototype.play = function () {\n    this.ambient.classList.add('active');\n    var self = this;\n\n    this.interval = setInterval(function () {\n\n        var applyTo = self.light1.classList.contains('active') ? self.light2 : self.light1;\n\n        // We show a 1x1 canvas in 100% width/height\n\n        if (!applyTo.children[0]) {\n            // If canvas doesn't exist, we create it\n            var canvas = document.createElement('canvas'),\n                context = canvas.getContext('2d');\n\n            canvas.width = 1;\n            canvas.height = 1;\n            canvas.classList.add('background');\n\n            applyTo.appendChild(canvas);\n        }\n\n        applyTo.children[0].getContext('2d').drawImage(self.video, 0, 0, 1, 1);\n\n        // As we can't do transition on gradient, we use 2 layers\n        // And we apply gradient to one, and do a transition on opacity\n        // Then next time we apply gradient to other one, etc...\n        self.light1.classList.toggle('active');\n        self.light2.classList.toggle('active');\n    }, 1000);\n};\n\nAmbientLight.prototype.stop = function () {\n    this.ambient.classList.remove('active');\n    clearInterval(this.interval);\n};\n'use strict';\n\n(function () {\n\n    // Variables\n    var canvas = $('.episode-2 .drawing canvas');\n    var video = $('.episode-2 .video');\n    var ambientLight = new AmbientLight(video, $('.episode-2 .ambient'));\n\n    App.bind('episode-2', 'loaded', function () {\n        // Begin canvas\n        // video.currentTime = 0;\n        video.play();\n        ambientLight.play();\n    });\n\n    App.bind('episode-2', 'unloading', function () {\n        // Stop the music\n        ambientLight.stop();\n    });\n\n    App.bind('episode-2', 'unloaded', function () {\n        // Clear canvas\n        // video.currentTime = 0;\n        video.pause();\n    });\n})();\n'use strict';\n\n(function () {\n\n    var episodeIsPlaying = false;\n\n    var canvas = $('.episode-1 .drawing canvas');\n    var video = $('.episode-1 .video');\n    var ambientLight = new AmbientLight(video, $('.episode-1 .ambient'));\n\n    if (!canvas || !canvas.getContext) return;\n\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n    var context = canvas.getContext('2d'),\n        width = canvas.width,\n        height = canvas.height;\n\n    var frequency = 30,\n        amplitudeCount = 30,\n        frequencyCount = 40;\n\n    // Tutorial from: http://apprentice.craic.com/tutorials/30\n\n    var audioContext;\n    var audioBuffer;\n    var sourceNode;\n    var analyserNode;\n    var javascriptNode;\n    var audioData = null;\n    var audioPlaying = false;\n    var sampleSize = 1024;\n    var amplitudeArray;\n    var frequencyArray;\n    var audioUrl = 'media/episode1.mp3';\n    var middleWidth = ~ ~(width / 2);\n    var middleHeight = ~ ~(height / 2);\n    var lastDraw = 0;\n    var energyInterval = -1;\n    var averageVolume = 0;\n    var sinOffset = Math.PI / 2;\n\n    var setupAudioNodes = function setupAudioNodes() {\n        sourceNode = audioContext.createBufferSource();\n        analyserNode = audioContext.createAnalyser();\n        javascriptNode = audioContext.createScriptProcessor(sampleSize, 1, 1);\n\n        // Create the array for the data values\n        amplitudeArray = new Uint8Array(analyserNode.frequencyBinCount);\n        frequencyArray = new Uint8Array(analyserNode.frequencyBinCount);\n        // Now connect the nodes together\n        sourceNode.connect(audioContext.destination);\n        sourceNode.connect(analyserNode);\n        analyserNode.connect(javascriptNode);\n        javascriptNode.connect(audioContext.destination);\n    };\n\n    // Load the audio from the URL via Ajax and store it in global variable audioData\n    // Note that the audio load is asynchronous\n    var loadSound = function loadSound(url) {\n        var request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.responseType = 'arraybuffer';\n        // When loaded, decode the data and play the sound\n        request.onload = function () {\n            audioContext.decodeAudioData(request.response, function (buffer) {\n                audioData = buffer;\n                playSound(audioData);\n            }, onError);\n        };\n        request.send();\n    };\n\n    // Play the audio and loop until stopped\n    var playSound = function playSound(buffer) {\n        sourceNode.buffer = buffer;\n        // sourceNode.start();    // Play the sound now\n        sourceNode.start(0);\n        sourceNode.loop = true;\n        audioPlaying = true;\n    };\n\n    var onError = function onError(e) {\n        console.warn(e);\n    };\n\n    var getAverageVolume = function getAverageVolume(array) {\n        var values = 0;\n        var average;\n\n        var length = array.length;\n\n        // get all the frequency amplitudes\n        for (var i = 0; i < length; i++) {\n            values += array[i];\n        }\n\n        average = values / length;\n        return average;\n    };\n\n    context.strokeStyle = 'white';\n    context.shadowBlur = 100;\n    context.shadowColor = 'rgb(220, 20, 220)';\n\n    var drawEnergy = function drawEnergy() {\n        // RANDOM ELECTRIC ARC\n\n        // clearCanvas();\n        context.lineWidth = 3;\n\n        var k,\n            i,\n            value = 0;\n        var amplitudeLength = amplitudeArray.length;\n        var amplitudeOffset = ~ ~(amplitudeLength / amplitudeCount);\n        var amplitudeDraw = ~ ~(width / amplitudeCount);\n        var size = 150;\n\n        context.beginPath();\n        context.moveTo(0, middleHeight);\n        k = 0;\n        for (i = amplitudeOffset; i < amplitudeLength - amplitudeOffset; i += amplitudeOffset) {\n            k++;\n            context.lineTo(k * amplitudeDraw, (Math.random() * size - size / 2) * averageVolume + middleHeight);\n        }\n        context.lineTo(width, middleHeight);\n        context.stroke();\n    };\n\n    var drawSound = function drawSound() {\n        if (episodeIsPlaying) {\n            clearCanvas();\n\n            var k,\n                i,\n                value = 0;\n\n            // FREQUENCY VARIABLE\n\n            var frenquencyLength = frequencyArray.length - 300;\n            var frenquencyOffset = ~ ~(frenquencyLength / frequencyCount);\n            var frequencyDraw = ~ ~(middleWidth / frequencyCount);\n\n            // DOUBLE FREQUENCY ARC - SYMMETRIC\n\n            context.lineWidth = ~ ~(3 + Math.random() * 6);\n            context.beginPath();\n            context.moveTo(0, middleHeight);\n\n            k = 0;\n            for (i = frenquencyLength - frenquencyOffset; i >= 0; i -= frenquencyOffset) {\n                k++;\n                value = frequencyArray[i + 5] / 256;\n                // context.lineTo(k * frequencyDraw, height - middleHeight - (value * middleHeight));\n                // context.lineTo(k * frequencyDraw, height - middleHeight - (value * middleHeight) * Math.sin(sinOffset + k / 5));\n                context.lineTo(k * frequencyDraw, height - middleHeight - value * middleHeight * Math.sin(sinOffset + k / 5) * averageVolume);\n            }\n\n            k = 0;\n            for (i = 0; i < frenquencyLength - frenquencyOffset * 2; i += frenquencyOffset) {\n                k++;\n                value = frequencyArray[i + 5] / 256;\n                // context.lineTo(middleWidth + k * frequencyDraw, height - middleHeight - (value * middleHeight));\n                // context.lineTo(middleWidth + k * frequencyDraw, height - middleHeight - (value * middleHeight) * Math.cos(sinOffset + k / 5));\n                context.lineTo(middleWidth + k * frequencyDraw, height - middleHeight - value * middleHeight * Math.cos(sinOffset + k / 5) * averageVolume);\n            }\n\n            context.lineTo(width, middleHeight);\n            context.stroke();\n\n            // AMPLITUDE VARIABLE\n\n            var amplitudeLength = amplitudeArray.length;\n            var amplitudeOffset = ~ ~(amplitudeLength / amplitudeCount);\n            var amplitudeDraw = ~ ~(width / amplitudeCount);\n\n            context.lineWidth = ~ ~(2 + Math.random() * 4);\n\n            context.beginPath();\n            context.moveTo(0, middleHeight);\n            k = 0;\n            for (i = amplitudeOffset; i < amplitudeLength - amplitudeOffset; i += amplitudeOffset) {\n                k++;\n                value = height - height * amplitudeArray[i] / 256 - 1;\n                context.lineTo(k * amplitudeDraw, value);\n            }\n            context.lineTo(width, middleHeight);\n            context.stroke();\n\n            context.beginPath();\n            context.moveTo(0, middleHeight);\n            k = 0;\n            for (i = amplitudeLength - amplitudeOffset; i >= amplitudeOffset; i -= amplitudeOffset) {\n                k++;\n                value = height - height * amplitudeArray[i] / 256 - 1;\n                context.lineTo(k * amplitudeDraw, value);\n            }\n            context.lineTo(width, middleHeight);\n            context.stroke();\n\n            // context.beginPath();\n            // context.moveTo(0, middleHeight);\n            // k = 0;\n            // for (i = amplitudeLength - amplitudeOffset; i >= amplitudeOffset; i -= amplitudeOffset) {\n            //     k++;\n            //     context.lineTo(k * amplitudeDraw, Math.random() * 50 - 25 + middleHeight);\n            // }\n            // context.lineTo(width, middleHeight);\n            // context.stroke();\n        }\n    };\n\n    var clearCanvas = function clearCanvas() {\n        context.clearRect(0, 0, width, height);\n    };\n\n    try {\n        audioContext = new AudioContext();\n    } catch (ex) {\n        console.warn('Web Audio API is not supported in this browser');\n    }\n\n    App.bind('episode-1', 'loaded', function () {\n        episodeIsPlaying = true;\n\n        setupAudioNodes();\n        video.currentTime = 0;\n        video.play();\n        ambientLight.play();\n\n        // setup the event handler that is triggered every time enough samples have been collected\n        // trigger the audio analysis and draw the results\n        javascriptNode.addEventListener('audioprocess', function (e) {\n            var now = new Date().getTime();\n            if (lastDraw > now - frequency) return;\n            lastDraw = now;\n            // get the Time Domain data for this sample\n            averageVolume = getAverageVolume(frequencyArray) / 100;\n            analyserNode.getByteTimeDomainData(amplitudeArray);\n            analyserNode.getByteFrequencyData(frequencyArray);\n\n            // draw the display if the audio is playing\n            if (audioPlaying === true) {\n                window.requestAnimationFrame(drawSound);\n            }\n        });\n\n        // Load the Audio the first time through, otherwise play it from the buffer\n        if (audioData === null) {\n            loadSound(audioUrl);\n        } else {\n            playSound(audioData);\n        }\n\n        energyInterval = setInterval(drawEnergy, 62);\n    });\n\n    App.bind('episode-1', 'unloading', function () {\n        clearInterval(energyInterval);\n        ambientLight.stop();\n        episodeIsPlaying = false;\n        sourceNode.stop(0);\n        audioPlaying = false;\n    });\n\n    App.bind('episode-1', 'unloaded', function () {\n        clearCanvas();\n        video.currentTime = 0;\n        video.pause();\n    });\n})();\n'use strict';\n\n(function () {\n\n    var episodeIsPlaying = false;\n\n    var canvas = $('.episode-2 .canvas');\n    var canvasEnergy = $('.episode-2 .drawing canvas');\n    var video = $('.episode-2 .video');\n    var ambientLight = new AmbientLight(video, $('.episode-2 .ambient'));\n\n    if (!canvas || !canvas.getContext) return;\n\n    canvas.width = 500;\n    canvas.height = 500;\n    canvasEnergy.width = window.innerWidth;\n    canvasEnergy.height = window.innerHeight;\n    var context = canvas.getContext('2d'),\n        energyCtx = canvasEnergy.getContext('2d'),\n        width = canvas.width,\n        height = canvas.height,\n        energyWidth = canvasEnergy.width,\n        energyHeight = canvasEnergy.height;\n\n    var frequency = 30,\n        amplitudeCount = 30,\n        frequencyCount = 40;\n\n    // Tutorial from: http://apprentice.craic.com/tutorials/30\n\n    var audioContext;\n    var audioBuffer;\n    var sourceNode;\n    var analyserNode;\n    var javascriptNode;\n    var audioData = null;\n    var audioPlaying = false;\n    var sampleSize = 1024;\n    var amplitudeArray;\n    var frequencyArray;\n    var audioUrl = 'media/episode2.mp3';\n    var middleWidth = ~ ~(energyWidth / 2);\n    var middleHeight = ~ ~(energyHeight / 2);\n    var lastDraw = 0;\n    var averageVolume = 0;\n    var particles = [];\n\n    var render = (function () {\n\n        var circles = [];\n        var initialized = false;\n        var height = 0;\n        var width = 0;\n        var init = function init(config) {\n            var count = config.count;\n            width = config.width;\n            height = config.height;\n            var circleMaxWidth = width * 0.106 >> 0;\n            var circlesEl = document.getElementById('circles');\n            for (var i = 0; i < count; i++) {\n                var node = document.createElement('div');\n                node.style.width = node.style.height = i / count * circleMaxWidth + 'px'; // increase the with and height of the circles\n                node.classList.add('circle'); // show circle\n                circles.push(node); // adds new circles\n                circlesEl.appendChild(node);\n            }\n            initialized = true;\n        };\n\n        var max = 256;\n\n        // make circles until he can't display another circle in the div\n        var renderFrame = function renderFrame(frequencyData) {\n\n            /* Var for change gradient and opacity */\n            var color_gradient = 0;\n            var increment_value = 16;\n            var opacity = 0;\n            var opacity_value = 0.05;\n\n            for (var i = 0; i < circles.length; i++) {\n                var circle = circles[i];\n                // Scale dynamicaly permit to change the height/width with the FrequancyData of the song\n                //and divided by max to control the radius\n                circle.style.cssText = '-webkit-transform:scale(' + frequencyData[i] / max + ')';\n                //setTimeout(function(){ atom.style.display = 'block'; }, 9900);\n\n                /* Condition who change dynamicaly the value of the rgba */\n                if (i < circles.length / 2) {\n                    color_gradient += increment_value;\n                    if (i < 1 / 1.5) {\n                        opacity += opacity_value;\n                    } else {\n                        opacity += opacity_value;\n                    }\n                } else {\n                    color_gradient -= increment_value;\n                }\n\n                // change the color of the circles\n                circle.style.backgroundColor = 'rgba(0,0,' + color_gradient + ',' + opacity_value + ')';\n            }\n        };\n        return {\n            init: init,\n            isInitialized: function isInitialized() {\n                return initialized;\n            },\n            renderFrame: renderFrame\n        };\n    })();\n\n    var setupAudioNodes = function setupAudioNodes() {\n        sourceNode = audioContext.createBufferSource();\n        analyserNode = audioContext.createAnalyser();\n        javascriptNode = audioContext.createScriptProcessor(sampleSize, 1, 1);\n\n        // Create the array for the data values\n        amplitudeArray = new Uint8Array(analyserNode.frequencyBinCount);\n        frequencyArray = new Uint8Array(analyserNode.frequencyBinCount);\n        // Now connect the nodes together\n        sourceNode.connect(audioContext.destination);\n        sourceNode.connect(analyserNode);\n        analyserNode.connect(javascriptNode);\n        // analyserNode.fftSize = 64;\n        javascriptNode.connect(audioContext.destination);\n    };\n\n    // Load the audio from the URL via Ajax and store it in global variable audioData\n    // Note that the audio load is asynchronous\n    var loadSound = function loadSound(url) {\n        var request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.responseType = 'arraybuffer';\n        // When loaded, decode the data and play the sound\n        request.onload = function () {\n            audioContext.decodeAudioData(request.response, function (buffer) {\n                audioData = buffer;\n                playSound(audioData);\n            }, onError);\n        };\n        request.send();\n    };\n\n    // Play the audio and loop until stopped\n    var playSound = function playSound(buffer) {\n        sourceNode.buffer = buffer;\n        // sourceNode.start();    // Play the sound now\n        sourceNode.start(0);\n        sourceNode.loop = true;\n        audioPlaying = true;\n    };\n\n    var onError = function onError(e) {\n        console.warn(e);\n    };\n\n    var getAverageVolume = function getAverageVolume(array) {\n        var values = 0;\n        var average;\n\n        var length = array.length;\n\n        // get all the frequency amplitudes\n        for (var i = 0; i < length; i++) {\n            values += array[i];\n        }\n\n        average = values / length;\n        return average;\n    };\n\n    var create_particle = function create_particle() {\n        var particle = {};\n        // position where the particle come\n        particle.x = 250;\n        particle.y = 250;\n        particle.speed = {};\n        particle.speed.x = Math.random() * 10 - 5;\n        particle.speed.y = Math.random() * 10 - 5;\n\n        particle.style = 'white'; // color gradient\n        particle.radius = 1; // made round particle\n        return particle;\n    };\n\n    var draw = function draw() {\n        for (var i = 0; i < particles.length; i++) {\n            var particle = particles[i];\n\n            if (particle.x < 0 || particle.x > canvas.width || particle.y < 0 || particle.y > canvas.height) {\n                particle = particles[i] = create_particle();\n            }\n\n            particle.x += particle.speed.x;\n            particle.y += particle.speed.y;\n\n            context.beginPath();\n            context.fillStyle = particle.style;\n            context.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2); // send particle at 360 degree\n            context.fill();\n        }\n    };\n\n    var drawSound = function drawSound() {\n        if (episodeIsPlaying) {\n            clearCanvas();\n            draw();\n\n            render.renderFrame(frequencyArray);\n\n            var k,\n                i,\n                value = 0;\n            energyCtx.strokeStyle = 'white';\n            energyCtx.shadowBlur = 100;\n            energyCtx.shadowColor = 'rgb(20, 20, 220)';\n\n            // FREQUENCY VARIABLE\n\n            var frenquencyLength = frequencyArray.length - 300;\n            var frenquencyOffset = ~ ~(frenquencyLength / frequencyCount);\n            var frequencyDraw = ~ ~(middleWidth / frequencyCount);\n            var drawing = -1;\n\n            // DOUBLE FREQUENCY ARC - SYMMETRIC\n\n            energyCtx.lineWidth = ~ ~(3 + Math.random() * 6);\n            energyCtx.beginPath();\n\n            k = 0;\n            for (i = frenquencyLength - frenquencyOffset; i >= 0; i -= frenquencyOffset) {\n                k++;\n                if (drawing > -1) {\n                    value = frequencyArray[i + 5] / 256;\n                    energyCtx.lineTo(k * frequencyDraw, energyHeight - middleHeight - value * middleHeight);\n                } else if (frequencyArray[i + 5] / 256 > 0.1) {\n                    drawing = i;\n                    energyCtx.moveTo(k * frequencyDraw, middleHeight);\n                }\n            }\n\n            k = 0;\n            for (i = 0; i < frenquencyLength - frenquencyOffset * 2 - (frenquencyLength - drawing); i += frenquencyOffset) {\n                k++;\n                value = frequencyArray[i + 5] / 256;\n                energyCtx.lineTo(middleWidth + k * frequencyDraw, energyHeight - middleHeight - value * middleHeight);\n            }\n            energyCtx.lineTo(middleWidth + k * frequencyDraw + frenquencyOffset, middleHeight);\n            energyCtx.stroke();\n\n            energyCtx.lineWidth = ~ ~(3 + Math.random() * 6);\n            energyCtx.beginPath();\n            energyCtx.moveTo(0, middleHeight);\n\n            k = 0;\n            drawing = -1;\n\n            for (i = frenquencyLength - frenquencyOffset; i >= 0; i -= frenquencyOffset) {\n                k++;\n                if (drawing > -1) {\n                    value = frequencyArray[i + 5] / 256;\n                    energyCtx.lineTo(k * frequencyDraw, energyHeight - middleHeight + value * middleHeight);\n                } else if (frequencyArray[i + 5] / 256 > 0.1) {\n                    drawing = i;\n                    energyCtx.moveTo(k * frequencyDraw, middleHeight);\n                }\n            }\n\n            k = 0;\n            for (i = 0; i < frenquencyLength - frenquencyOffset * 2 - (frenquencyLength - drawing); i += frenquencyOffset) {\n                k++;\n                value = frequencyArray[i + 5] / 256;\n                energyCtx.lineTo(middleWidth + k * frequencyDraw, energyHeight - middleHeight + value * middleHeight);\n            }\n\n            energyCtx.lineTo(middleWidth + k * frequencyDraw + frenquencyOffset, middleHeight);\n            energyCtx.stroke();\n        }\n    };\n    // clear canvas\n    var clearCanvas = function clearCanvas() {\n        context.clearRect(0, 0, width, height);\n        energyCtx.clearRect(0, 0, energyWidth, energyHeight);\n    };\n\n    try {\n        audioContext = new AudioContext();\n    } catch (ex) {\n        console.warn('Web Audio API is not supported in this browser');\n    }\n\n    for (var i = 0; i < 100; i++) {\n        particles.push(create_particle());\n    }\n\n    App.bind('episode-2', 'loaded', function () {\n        episodeIsPlaying = true;\n\n        setupAudioNodes();\n        video.currentTime = 0;\n        video.play();\n        ambientLight.play();\n\n        if (!render.isInitialized()) {\n            render.init({\n                // count: analyserNode.frequencyBinCount,\n                count: 10,\n                width: 360,\n                height: 360\n            });\n        }\n\n        // setup the event handler that is triggered every time enough samples have been collected\n        // trigger the audio analysis and draw the results\n        javascriptNode.addEventListener('audioprocess', function (e) {\n            var now = new Date().getTime();\n            if (lastDraw > now - frequency) return;\n            lastDraw = now;\n            // get the Time Domain data for this sample\n            // averageVolume = getAverageVolume(frequencyArray) / 100;\n            // analyserNode.getByteTimeDomainData(amplitudeArray);\n            analyserNode.getByteFrequencyData(frequencyArray);\n\n            // draw the display if the audio is playing\n            if (audioPlaying === true) {\n                window.requestAnimationFrame(drawSound);\n            }\n        });\n\n        // Load the Audio the first time through, otherwise play it from the buffer\n        if (audioData === null) {\n            loadSound(audioUrl);\n        } else {\n            playSound(audioData);\n        }\n    });\n\n    App.bind('episode-2', 'unloading', function () {\n        ambientLight.stop();\n        episodeIsPlaying = false;\n        sourceNode.stop(0);\n        audioPlaying = false;\n    });\n\n    App.bind('episode-2', 'unloaded', function () {\n        clearCanvas();\n        video.currentTime = 0;\n        video.pause();\n    });\n})();\n'use strict';\n\n(function () {\n\n    var GLOBAL_SPEED = 0.1,\n        HYPERSPACE_RUN = true;\n\n    App.bind('home', 'unloading', function () {\n        var interval = setInterval(function () {\n            GLOBAL_SPEED = (GLOBAL_SPEED + 0.1) * 1.3;\n            if (GLOBAL_SPEED > 70) {\n                clearInterval(interval);\n            }\n        }, 100);\n\n        var home = $('.page.home'),\n            select = $('.page.select');\n\n        // select.addEventListener('animationend', function begin(e) {\n        //     select.removeEventListener('animationend', begin);\n        // });\n\n        home.classList.add('exit-hyperspace');\n        select.classList.add('enter-hyperspace');\n    });\n\n    App.bind('home', 'unloaded', function () {\n        HYPERSPACE_RUN = false;\n\n        var home = $('.page.home'),\n            select = $('.page.select');\n\n        home.classList.remove('visible');\n        home.classList.remove('exit-hyperspace');\n        select.classList.remove('enter-hyperspace');\n    });\n\n    (function (canvas) {\n\n        canvas.width = window.innerWidth;\n        canvas.height = window.innerHeight;\n\n        if (canvas.getContext) {\n            var context = canvas.getContext('2d'),\n                width = canvas.width,\n                height = canvas.height,\n                starsCount = 100,\n                centerRadius = 100,\n                length = 10,\n                stars = [];\n\n            var createStar = function createStar() {\n                var randomX = Math.random(),\n                    randomY = Math.random(),\n                    color = ~ ~(Math.random() * 80 + 20);\n\n                return {\n                    x: randomX * width,\n                    y: randomY * height,\n                    xs: (randomX * width - width / 2) / 500,\n                    ys: (randomY * height - height / 2) / 500,\n                    size: ~ ~(color / 20),\n                    length: Math.random() * length,\n                    color: 'rgb(' + color + ', ' + color + ', ' + ~ ~(color + Math.random() * 20) + ')'\n                };\n            };\n\n            for (var i = 0; i < starsCount; i++) {\n                stars.push(createStar());\n            }\n\n            (function loop() {\n                if (HYPERSPACE_RUN) {\n\n                    window.requestAnimationFrame(loop);\n                    context.clearRect(0, 0, width, height);\n\n                    for (var i = 0; i < starsCount; i++) {\n                        var s = stars[i];\n                        if (s.x < 0 || s.y < 0 || s.x > width || s.y > height) {\n                            s = stars[i] = createStar();\n                        }\n                        context.strokeStyle = s.color;\n                        context.lineWidth = s.size;\n                        context.shadowBlur = 5;\n                        context.lineCap = 'round';\n                        context.shadowColor = \"#555\";\n                        context.beginPath();\n                        context.moveTo(s.x, s.y);\n                        context.lineTo(s.x + 0.1 + s.length * s.xs * GLOBAL_SPEED, s.y + s.length * s.ys * GLOBAL_SPEED);\n                        context.stroke();\n                        s.x += s.xs * GLOBAL_SPEED;\n                        s.y += s.ys * GLOBAL_SPEED;\n                    }\n                }\n            })();\n        }\n    })($('.hyperspace'));\n})();\n'use strict';\n\n(function () {\n\n    var preloadImages = function preloadImages(urls) {\n        for (var i = urls.length - 1; i >= 0; i--) {\n            var img = new Image();\n            img.src = urls[i];\n        }\n    };\n\n    App.init = function () {\n\n        preloadImages(['img/film-1.jpg', 'img/film-2.jpg', 'img/film-3.jpg', 'img/film-4.jpg', 'img/film-5.jpg', 'img/film-6.jpg', 'img/film-7.jpg', 'img/lock.svg', 'img/star-wars-logo.svg', 'img/starship-left.png', 'img/starship-right.png', 'img/vote-left.jpg', 'img/vote-right.jpg']);\n\n        window.addEventListener('load', function () {\n            var loader = $('section.loader');\n            if (loader) {\n                loader.addEventListener('transitionend', function () {\n                    loader.classList.remove('visible', 'fade-out');\n                });\n                loader.classList.add('fade-out');\n            }\n            if (window.location.hash && window.location.hash.length > 2) {\n                var hash = window.location.hash.substring(2),\n                    page = $('.page.' + hash);\n\n                if (page && page.classList.contains('page')) {\n                    page.classList.add('visible');\n                    App.call(hash, 'loading');\n                    App.call(hash, 'loaded');\n                    return;\n                }\n            }\n            $('.page.home').classList.add('visible');\n            App.call('home', 'loading');\n            App.call('home', 'loaded');\n        });\n    };\n})();\n'use strict';\n\n/**\r\n * Navigation between pages\r\n *\r\n */\n\n(function () {\n\n    // Bind begin button to hyperspace animation\n    $('.begin').addEventListener('click', function (e) {\n        App.call('home', 'unloading');\n        App.call('select', 'loading');\n        var select = $('.page.select');\n        select.addEventListener('animationend', function begin(e) {\n            select.removeEventListener('animationend', begin);\n            App.call('home', 'unloaded');\n            App.call('select', 'loaded');\n            $('.page.select').classList.add('visible');\n            App.setLocation('select');\n        });\n    });\n\n    // Bind navigation elements to animations\n    var bindNavigation = function bindNavigation(element) {\n        element.addEventListener('click', function (e) {\n            if (this.getAttribute('data-target')) {\n                App.goto(this.getAttribute('data-target'), this.getAttribute('data-direction') === 'up');\n            }\n            e.preventDefault();\n        });\n    };\n\n    var elements = $$('.navigation');\n    for (var i = elements.length - 1; i >= 0; i--) {\n        bindNavigation(elements[i]);\n    }\n\n    // Change page if hash change\n    window.addEventListener('hashchange', App.gotoHash);\n})();\n'use strict';\n\n/**\r\n * Episode selection\r\n *\r\n */\n\n(function () {\n\n    var select = {\n        lastMove: 0,\n        leftOffset: window.screen.width / 2 - 100,\n        rightOffset: 0,\n        screenScale: 100 - 100 / 1.75,\n        selectCards: $('.select .cards')\n    };\n\n    select.percentDivisor = window.screen.width - select.rightOffset - select.leftOffset;\n\n    var selectionListener = function selectionListener(event) {\n        var now = new Date().getTime();\n        if (select.lastMove < now - 20) {\n\n            select.lastMove = now;\n            var percent = (event.screenX - select.leftOffset) / select.percentDivisor;\n\n            if (percent < 0) {\n                percent = 0;\n            } else if (percent > 1) {\n                percent = 1;\n            }\n\n            select.selectCards.style.transform = 'translateZ(0) translateX(-' + percent * select.screenScale + '%)';\n        }\n    };\n\n    App.bind('select', 'loading', function () {\n        document.addEventListener('mousemove', selectionListener);\n    });\n\n    App.bind('select', 'unloading', function () {\n        document.removeEventListener('mousemove', selectionListener);\n    });\n})();\n'use strict';\n\n(function () {\n\n    var buttons = $$('.button-vote');\n    var bindVote = function bindVote(elt) {\n        elt.addEventListener('click', function (e) {\n            for (var i = buttons.length - 1; i >= 0; i--) {\n                buttons[i].innerHTML = \"Je vote\";\n            }\n            elt.innerHTML = \"Vote validé !\";\n        });\n    };\n\n    for (var i = buttons.length - 1; i >= 0; i--) {\n        bindVote(buttons[i]);\n    }\n})();\n'use strict';\n\n// Load the page\nApp.init();\n\n// Everything is OK !\nconsole.log('Libs and App loaded !');","\r\nfunction AmbientLight(video, ambient) {\r\n    this.video = video;\r\n    this.ambient = ambient;\r\n    this.light1 = $('.light-1', ambient);\r\n    this.light2 = $('.light-2', ambient);\r\n    this.interval = -1;\r\n}\r\n\r\nAmbientLight.prototype.play = function() {\r\n    this.ambient.classList.add('active');\r\n    var self = this;\r\n\r\n    this.interval = setInterval(function () {\r\n    \r\n        var applyTo = self.light1.classList.contains('active') ? self.light2 : self.light1;\r\n\r\n        // We show a 1x1 canvas in 100% width/height\r\n\r\n        if (!applyTo.children[0]) {\r\n            // If canvas doesn't exist, we create it\r\n            var canvas = document.createElement('canvas'),\r\n                context = canvas.getContext('2d');\r\n\r\n            canvas.width = 1;\r\n            canvas.height = 1;\r\n            canvas.classList.add('background');\r\n\r\n            applyTo.appendChild(canvas);\r\n        }\r\n\r\n        applyTo.children[0].getContext('2d').drawImage(self.video, 0, 0, 1, 1);\r\n\r\n        // As we can't do transition on gradient, we use 2 layers\r\n        // And we apply gradient to one, and do a transition on opacity\r\n        // Then next time we apply gradient to other one, etc...\r\n        self.light1.classList.toggle('active');\r\n        self.light2.classList.toggle('active');\r\n\r\n    }, 1000);\r\n};\r\n\r\nAmbientLight.prototype.stop = function() {\r\n    this.ambient.classList.remove('active');\r\n    clearInterval(this.interval);\r\n};\r\n","/**\r\n * Create App object\r\n *\r\n */\r\n\r\nvar App = {},\r\n    $ = document.querySelector.bind(document),\r\n    $$ = document.querySelectorAll.bind(document);\r\n\r\n(function () {\r\n\r\n    App.goto = function (identifier, gotoUp) {\r\n        var current = $('section.visible'),\r\n            next = $('.page.' + identifier),\r\n            direction = gotoUp ? 'up' : 'down';\r\n\r\n        if (!next || typeof gotoUp !== 'boolean') {\r\n            throw new Error('Wrong arguments: ' + next + ', ' + gotoUp);\r\n        } else if (current == next) {\r\n            throw new Error('Moving to the same page..');\r\n        } else {\r\n            if (current) {\r\n                var currentName = current.getAttribute('data-page');\r\n                App.call(currentName, 'unloading');\r\n                current.classList.remove('visible');\r\n                current.classList.add('exit-' + direction);\r\n                current.addEventListener('animationend', function animationend(e) {\r\n                    App.call(currentName, 'unloaded');\r\n                    current.removeEventListener('animationend', animationend);\r\n                    current.classList.remove('exit-' + direction);\r\n                });\r\n            }\r\n            App.call(identifier, 'loading');\r\n            next.classList.add('visible');\r\n            next.classList.add('enter-' + direction);\r\n            next.addEventListener('animationend', function animationend(e) {\r\n                App.call(identifier, 'loaded');\r\n                next.removeEventListener('animationend', animationend);\r\n                next.classList.remove('enter-' + direction);\r\n                if (identifier !== 'home') {\r\n                    App.setLocation(identifier);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    App.home = function () {\r\n        // Rerun the page to restart the canvas\r\n        if (window.location.href) {\r\n             window.location.href = window.location.href.substring(0, window.location.href.indexOf('#') - 1);\r\n        } else {\r\n            window.location.reload();\r\n        }\r\n    };\r\n\r\n    var isChangingHash = false;\r\n\r\n    App.setLocation = function (hash) {\r\n        isChangingHash = true;\r\n        window.location.hash = '#/' + hash;\r\n        setTimeout(function () {\r\n            isChangingHash = false;\r\n        }, 1);\r\n    };\r\n\r\n    App.gotoHash = function (homeFallback) {\r\n        if (isChangingHash) return;\r\n        if (window.location.hash && window.location.hash.length > 2) {\r\n            var hash = window.location.hash.substring(2),\r\n                page = $('.page.' + hash);\r\n\r\n            if (hash === 'home') {\r\n                App.home();\r\n                return;\r\n            } else if (page && page.classList.contains('page')) {\r\n                var current = $('section.visible');\r\n                if (current) {\r\n                    current.classList.remove('visible');\r\n                    var currentName = current.getAttribute('data-page');\r\n                    App.call(currentName, 'unloading');\r\n                    App.call(currentName, 'unloaded');\r\n                }\r\n                page.classList.add('visible');\r\n                App.call(hash, 'loading');\r\n                App.call(hash, 'loaded');\r\n                window.HYPERSPACE = false;\r\n                return;\r\n            }\r\n        }\r\n        if (homeFallback) {\r\n            App.home();\r\n        }\r\n    };\r\n\r\n    var callbacks = {};\r\n    \r\n    App.call = function (page, state) {\r\n        if (callbacks[page] && callbacks[page][state]) {\r\n            for (var i = callbacks[page][state].length - 1; i >= 0; i--) {\r\n                callbacks[page][state][i]();\r\n            }\r\n        }\r\n    };\r\n\r\n    App.bind = function (page, state, callback) {\r\n        if (!callbacks[page]) {\r\n            callbacks[page] = {};\r\n        }\r\n        if (!callbacks[page][state]) {\r\n            callbacks[page][state] = [];\r\n        }\r\n        callbacks[page][state].push(callback);\r\n    };\r\n\r\n})();\r\n\r\n","\r\nwindow.AudioContext = (function() {\r\n    return  window.AudioContext || window.webkitAudioContext || window.mozAudioContext;\r\n})();\r\n","/* Compatible avec tous les navigateurs */\r\n(function() {\r\n    var lastTime = 0;\r\n    var vendors = ['webkit', 'moz'];\r\n    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\r\n        window.cancelAnimationFrame =\r\n          window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];\r\n    }\r\n\r\n    if (!window.requestAnimationFrame)\r\n        window.requestAnimationFrame = function(callback, element) {\r\n            var currTime = new Date().getTime();\r\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n            var id = window.setTimeout(function() { callback(currTime + timeToCall); },\r\n              timeToCall);\r\n            lastTime = currTime + timeToCall;\r\n            return id;\r\n        };\r\n\r\n    if (!window.cancelAnimationFrame)\r\n        window.cancelAnimationFrame = function(id) {\r\n            clearTimeout(id);\r\n        };\r\n}());\r\n","\r\n(function () {\r\n\r\n    // Variables\r\n    var canvas = $('.episode-2 .drawing canvas');\r\n    var video = $('.episode-2 .video');\r\n    var ambientLight = new AmbientLight(video, $('.episode-2 .ambient'));\r\n\r\n\r\n\r\n    App.bind('episode-2', 'loaded', function () {\r\n        // Begin canvas\r\n        // video.currentTime = 0;\r\n        video.play();\r\n        ambientLight.play();\r\n\r\n\r\n\r\n    });\r\n\r\n    App.bind('episode-2', 'unloading', function () {\r\n        // Stop the music\r\n        ambientLight.stop();\r\n\r\n\r\n\r\n    });\r\n\r\n    App.bind('episode-2', 'unloaded', function () {\r\n        // Clear canvas\r\n        // video.currentTime = 0;\r\n        video.pause();\r\n\r\n    });\r\n\r\n})();\r\n","\r\n(function () {\r\n\r\n    var episodeIsPlaying = false;\r\n\r\n    var canvas = $('.episode-1 .drawing canvas');\r\n    var video = $('.episode-1 .video');\r\n    var ambientLight = new AmbientLight(video, $('.episode-1 .ambient'));\r\n\r\n    if (!canvas || !canvas.getContext) return;\r\n\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n    var context = canvas.getContext('2d'),\r\n        width = canvas.width,\r\n        height = canvas.height;\r\n\r\n    var frequency = 30,\r\n        amplitudeCount = 30,\r\n        frequencyCount = 40;\r\n\r\n    // Tutorial from: http://apprentice.craic.com/tutorials/30\r\n\r\n    var audioContext;\r\n    var audioBuffer;\r\n    var sourceNode;\r\n    var analyserNode;\r\n    var javascriptNode;\r\n    var audioData = null;\r\n    var audioPlaying = false;\r\n    var sampleSize = 1024;\r\n    var amplitudeArray;\r\n    var frequencyArray;\r\n    var audioUrl = 'media/episode1.mp3';\r\n    var middleWidth = ~~(width / 2);\r\n    var middleHeight = ~~(height / 2);\r\n    var lastDraw = 0;\r\n    var energyInterval = -1;\r\n    var averageVolume = 0;\r\n    var sinOffset = Math.PI / 2;\r\n\r\n    var setupAudioNodes = function () {\r\n        sourceNode     = audioContext.createBufferSource();\r\n        analyserNode   = audioContext.createAnalyser();\r\n        javascriptNode = audioContext.createScriptProcessor(sampleSize, 1, 1);\r\n\r\n        // Create the array for the data values\r\n        amplitudeArray = new Uint8Array(analyserNode.frequencyBinCount);\r\n        frequencyArray = new Uint8Array(analyserNode.frequencyBinCount);\r\n        // Now connect the nodes together\r\n        sourceNode.connect(audioContext.destination);\r\n        sourceNode.connect(analyserNode);\r\n        analyserNode.connect(javascriptNode);\r\n        javascriptNode.connect(audioContext.destination);\r\n    };\r\n\r\n    // Load the audio from the URL via Ajax and store it in global variable audioData\r\n    // Note that the audio load is asynchronous\r\n    var loadSound = function (url) {\r\n        var request = new XMLHttpRequest();\r\n        request.open('GET', url, true);\r\n        request.responseType = 'arraybuffer';\r\n        // When loaded, decode the data and play the sound\r\n        request.onload = function () {\r\n            audioContext.decodeAudioData(request.response, function (buffer) {\r\n                audioData = buffer;\r\n                playSound(audioData);\r\n            }, onError);\r\n        };\r\n        request.send();\r\n    };\r\n\r\n    // Play the audio and loop until stopped\r\n    var playSound = function (buffer) {\r\n        sourceNode.buffer = buffer;\r\n        // sourceNode.start();    // Play the sound now\r\n        sourceNode.start(0);\r\n        sourceNode.loop = true;\r\n        audioPlaying = true;\r\n    };\r\n\r\n    var onError = function (e) {\r\n        console.warn(e);\r\n    };\r\n\r\n    var getAverageVolume = function (array) {\r\n        var values = 0;\r\n        var average;\r\n \r\n        var length = array.length;\r\n \r\n        // get all the frequency amplitudes\r\n        for (var i = 0; i < length; i++) {\r\n            values += array[i];\r\n        }\r\n \r\n        average = values / length;\r\n        return average;\r\n    };\r\n\r\n    context.strokeStyle = 'white';\r\n    context.shadowBlur = 100;\r\n    context.shadowColor = 'rgb(220, 20, 220)';\r\n\r\n    var drawEnergy = function () {\r\n        // RANDOM ELECTRIC ARC\r\n\r\n        // clearCanvas();\r\n        context.lineWidth = 3;\r\n\r\n        var k, i, value = 0;\r\n        var amplitudeLength = amplitudeArray.length;\r\n        var amplitudeOffset = ~~(amplitudeLength / amplitudeCount);\r\n        var amplitudeDraw = ~~(width / amplitudeCount);\r\n        var size = 150;\r\n\r\n        context.beginPath();\r\n        context.moveTo(0, middleHeight);\r\n        k = 0;\r\n        for (i = amplitudeOffset; i < amplitudeLength - amplitudeOffset; i += amplitudeOffset) {\r\n            k++;\r\n            context.lineTo(k * amplitudeDraw, (Math.random() * size - size/2) * averageVolume + middleHeight);\r\n        }\r\n        context.lineTo(width, middleHeight);\r\n        context.stroke();\r\n    };\r\n\r\n    var drawSound = function () {\r\n        if (episodeIsPlaying) {\r\n            clearCanvas();\r\n\r\n            var k, i, value = 0;\r\n\r\n            // FREQUENCY VARIABLE\r\n\r\n            var frenquencyLength = frequencyArray.length - 300;\r\n            var frenquencyOffset = ~~(frenquencyLength / frequencyCount);\r\n            var frequencyDraw = ~~(middleWidth / frequencyCount);\r\n\r\n            // DOUBLE FREQUENCY ARC - SYMMETRIC\r\n\r\n            context.lineWidth = ~~(3 + Math.random() * 6);\r\n            context.beginPath();\r\n            context.moveTo(0, middleHeight);\r\n\r\n            k = 0;\r\n            for (i = frenquencyLength - frenquencyOffset; i >= 0; i -= frenquencyOffset) {\r\n                k++;\r\n                value = frequencyArray[i + 5] / 256;\r\n                // context.lineTo(k * frequencyDraw, height - middleHeight - (value * middleHeight));\r\n                // context.lineTo(k * frequencyDraw, height - middleHeight - (value * middleHeight) * Math.sin(sinOffset + k / 5));\r\n                context.lineTo(k * frequencyDraw, height - middleHeight - (value * middleHeight) * Math.sin(sinOffset + k / 5) * averageVolume);\r\n            }\r\n\r\n            k = 0;\r\n            for (i = 0; i < frenquencyLength - frenquencyOffset * 2; i += frenquencyOffset) {\r\n                k++;\r\n                value = frequencyArray[i + 5] / 256;\r\n                // context.lineTo(middleWidth + k * frequencyDraw, height - middleHeight - (value * middleHeight));\r\n                // context.lineTo(middleWidth + k * frequencyDraw, height - middleHeight - (value * middleHeight) * Math.cos(sinOffset + k / 5));\r\n                context.lineTo(middleWidth + k * frequencyDraw, height - middleHeight - (value * middleHeight) * Math.cos(sinOffset + k / 5) * averageVolume);\r\n            }\r\n\r\n            context.lineTo(width, middleHeight);\r\n            context.stroke();\r\n\r\n            // AMPLITUDE VARIABLE\r\n\r\n            var amplitudeLength = amplitudeArray.length;\r\n            var amplitudeOffset = ~~(amplitudeLength / amplitudeCount);\r\n            var amplitudeDraw = ~~(width / amplitudeCount);\r\n\r\n            context.lineWidth = ~~(2 + Math.random() * 4);\r\n\r\n            context.beginPath();\r\n            context.moveTo(0, middleHeight);\r\n            k = 0;\r\n            for (i = amplitudeOffset; i < amplitudeLength - amplitudeOffset; i += amplitudeOffset) {\r\n                k++;\r\n                value = height - (height * amplitudeArray[i] / 256) - 1;\r\n                context.lineTo(k * amplitudeDraw, value);\r\n\r\n            }\r\n            context.lineTo(width, middleHeight);\r\n            context.stroke();\r\n\r\n\r\n            context.beginPath();\r\n            context.moveTo(0, middleHeight);\r\n            k = 0;\r\n            for (i = amplitudeLength - amplitudeOffset; i >= amplitudeOffset; i -= amplitudeOffset) {\r\n                k++;\r\n                value = height - (height * amplitudeArray[i] / 256) - 1;\r\n                context.lineTo(k * amplitudeDraw, value);\r\n            }\r\n            context.lineTo(width, middleHeight);\r\n            context.stroke();\r\n\r\n            // context.beginPath();\r\n            // context.moveTo(0, middleHeight);\r\n            // k = 0;\r\n            // for (i = amplitudeLength - amplitudeOffset; i >= amplitudeOffset; i -= amplitudeOffset) {\r\n            //     k++;\r\n            //     context.lineTo(k * amplitudeDraw, Math.random() * 50 - 25 + middleHeight);\r\n            // }\r\n            // context.lineTo(width, middleHeight);\r\n            // context.stroke();\r\n        }\r\n    };\r\n\r\n    var clearCanvas = function () {\r\n        context.clearRect(0, 0, width, height);\r\n    };\r\n\r\n    try {\r\n        audioContext = new AudioContext();\r\n    } catch (ex) {\r\n        console.warn('Web Audio API is not supported in this browser');\r\n    }\r\n\r\n\r\n    App.bind('episode-1', 'loaded', function () {\r\n        episodeIsPlaying = true;\r\n\r\n        setupAudioNodes();\r\n        video.currentTime = 0;\r\n        video.play();\r\n        ambientLight.play();\r\n\r\n        // setup the event handler that is triggered every time enough samples have been collected\r\n        // trigger the audio analysis and draw the results\r\n        javascriptNode.addEventListener('audioprocess', function (e) {\r\n            var now = new Date().getTime();\r\n            if (lastDraw > now - frequency) return;\r\n            lastDraw = now;\r\n            // get the Time Domain data for this sample\r\n            averageVolume = getAverageVolume(frequencyArray) / 100;\r\n            analyserNode.getByteTimeDomainData(amplitudeArray);\r\n            analyserNode.getByteFrequencyData(frequencyArray);\r\n\r\n            // draw the display if the audio is playing\r\n            if (audioPlaying === true) {\r\n                window.requestAnimationFrame(drawSound);\r\n            }\r\n        });\r\n\r\n        // Load the Audio the first time through, otherwise play it from the buffer\r\n        if (audioData === null) {\r\n            loadSound(audioUrl);\r\n        } else {\r\n            playSound(audioData);\r\n        }\r\n\r\n        energyInterval = setInterval(drawEnergy, 62);\r\n\r\n    });\r\n\r\n    App.bind('episode-1', 'unloading', function () {\r\n        clearInterval(energyInterval);\r\n        ambientLight.stop();\r\n        episodeIsPlaying = false;\r\n        sourceNode.stop(0);\r\n        audioPlaying = false;\r\n    });\r\n\r\n    App.bind('episode-1', 'unloaded', function () {\r\n        clearCanvas();\r\n        video.currentTime = 0;\r\n        video.pause();\r\n    });\r\n\r\n})();\r\n","\r\n(function () {\r\n\r\n    var episodeIsPlaying = false;\r\n\r\n    var canvas = $('.episode-2 .canvas');\r\n    var canvasEnergy = $('.episode-2 .drawing canvas');\r\n    var video = $('.episode-2 .video');\r\n    var ambientLight = new AmbientLight(video, $('.episode-2 .ambient'));\r\n\r\n    if (!canvas || !canvas.getContext) return;\r\n\r\n    canvas.width = 500;\r\n    canvas.height = 500;\r\n    canvasEnergy.width = window.innerWidth;\r\n    canvasEnergy.height = window.innerHeight;\r\n    var context = canvas.getContext('2d'),\r\n        energyCtx = canvasEnergy.getContext('2d'),\r\n        width = canvas.width,\r\n        height = canvas.height,\r\n        energyWidth = canvasEnergy.width,\r\n        energyHeight = canvasEnergy.height;\r\n\r\n    var frequency = 30,\r\n        amplitudeCount = 30,\r\n        frequencyCount = 40;\r\n\r\n    // Tutorial from: http://apprentice.craic.com/tutorials/30\r\n\r\n    var audioContext;\r\n    var audioBuffer;\r\n    var sourceNode;\r\n    var analyserNode;\r\n    var javascriptNode;\r\n    var audioData = null;\r\n    var audioPlaying = false;\r\n    var sampleSize = 1024;\r\n    var amplitudeArray;\r\n    var frequencyArray;\r\n    var audioUrl = 'media/episode2.mp3';\r\n    var middleWidth = ~~(energyWidth / 2);\r\n    var middleHeight = ~~(energyHeight / 2);\r\n    var lastDraw = 0;\r\n    var averageVolume = 0;\r\n    var particles = [];\r\n\r\n    var render = (function() {\r\n\r\n        var circles = [];\r\n        var initialized = false;\r\n        var height = 0;\r\n        var width = 0;\r\n        var init = function(config) {\r\n            var count = config.count;\r\n            width = config.width;\r\n            height = config.height;\r\n            var circleMaxWidth = (width * 0.106) >> 0;\r\n            var circlesEl = document.getElementById('circles');\r\n            for (var i = 0; i < count; i++) {\r\n                var node = document.createElement('div');\r\n                node.style.width = node.style.height = (i / count * circleMaxWidth) + 'px'; // increase the with and height of the circles\r\n                node.classList.add('circle'); // show circle\r\n                circles.push(node); // adds new circles\r\n                circlesEl.appendChild(node);\r\n               }\r\n            initialized = true;\r\n        };\r\n\r\n        var max = 256;\r\n\r\n        // make circles until he can't display another circle in the div\r\n        var renderFrame = function(frequencyData) {\r\n\r\n          /* Var for change gradient and opacity */\r\n          var color_gradient = 0;\r\n          var increment_value = 16;\r\n          var opacity = 0;\r\n          var opacity_value = 0.05;\r\n\r\n            for (var i = 0; i < circles.length; i++) {\r\n                var circle = circles[i];\r\n                // Scale dynamicaly permit to change the height/width with the FrequancyData of the song\r\n                //and divided by max to control the radius\r\n                circle.style.cssText = '-webkit-transform:scale(' + ((frequencyData[i] / max)) + ')';\r\n                //setTimeout(function(){ atom.style.display = 'block'; }, 9900);\r\n\r\n\r\n                /* Condition who change dynamicaly the value of the rgba */\r\n                  if(i < circles.length / 2 )\r\n                  {\r\n                    color_gradient += increment_value;\r\n                    if(i < 1/ 1.5) {\r\n                      opacity += opacity_value;\r\n                    } else {\r\n                        opacity += opacity_value;\r\n                    }\r\n                  }\r\n                  else\r\n                  {\r\n                    color_gradient -= increment_value;\r\n                  }\r\n\r\n                  // change the color of the circles\r\n                  circle.style.backgroundColor = 'rgba(0,0,'  + color_gradient + ',' + opacity_value + ')';\r\n           }\r\n        };\r\n        return {\r\n            init: init,\r\n            isInitialized: function() {\r\n                return initialized;\r\n            },\r\n            renderFrame: renderFrame\r\n        };\r\n\r\n    })();\r\n\r\n    var setupAudioNodes = function () {\r\n        sourceNode     = audioContext.createBufferSource();\r\n        analyserNode   = audioContext.createAnalyser();\r\n        javascriptNode = audioContext.createScriptProcessor(sampleSize, 1, 1);\r\n\r\n        // Create the array for the data values\r\n        amplitudeArray = new Uint8Array(analyserNode.frequencyBinCount);\r\n        frequencyArray = new Uint8Array(analyserNode.frequencyBinCount);\r\n        // Now connect the nodes together\r\n        sourceNode.connect(audioContext.destination);\r\n        sourceNode.connect(analyserNode);\r\n        analyserNode.connect(javascriptNode);\r\n        // analyserNode.fftSize = 64;\r\n        javascriptNode.connect(audioContext.destination);\r\n    };\r\n\r\n    // Load the audio from the URL via Ajax and store it in global variable audioData\r\n    // Note that the audio load is asynchronous\r\n    var loadSound = function (url) {\r\n        var request = new XMLHttpRequest();\r\n        request.open('GET', url, true);\r\n        request.responseType = 'arraybuffer';\r\n        // When loaded, decode the data and play the sound\r\n        request.onload = function () {\r\n            audioContext.decodeAudioData(request.response, function (buffer) {\r\n                audioData = buffer;\r\n                playSound(audioData);\r\n            }, onError);\r\n        };\r\n        request.send();\r\n    };\r\n\r\n    // Play the audio and loop until stopped\r\n    var playSound = function (buffer) {\r\n        sourceNode.buffer = buffer;\r\n        // sourceNode.start();    // Play the sound now\r\n        sourceNode.start(0);\r\n        sourceNode.loop = true;\r\n        audioPlaying = true;\r\n    };\r\n\r\n    var onError = function (e) {\r\n        console.warn(e);\r\n    };\r\n\r\n    var getAverageVolume = function (array) {\r\n        var values = 0;\r\n        var average;\r\n\r\n        var length = array.length;\r\n\r\n        // get all the frequency amplitudes\r\n        for (var i = 0; i < length; i++) {\r\n            values += array[i];\r\n        }\r\n\r\n        average = values / length;\r\n        return average;\r\n    };\r\n\r\n    var create_particle = function () {\r\n        var particle = {};\r\n        // position where the particle come\r\n        particle.x = 250;\r\n        particle.y = 250;\r\n        particle.speed = {};\r\n        particle.speed.x = Math.random() * 10 - 5;\r\n        particle.speed.y = Math.random() * 10 - 5;\r\n\r\n        particle.style = 'white'; // color gradient\r\n        particle.radius = 1; // made round particle\r\n        return particle;\r\n    };\r\n\r\n    var draw = function () {\r\n        for(var i = 0; i < particles.length; i++) {\r\n            var particle = particles [ i ];\r\n\r\n            if (particle.x < 0 || particle.x > canvas.width || particle.y < 0 || particle.y > canvas.height) {\r\n                particle = particles[i] = create_particle();\r\n            }\r\n\r\n            particle.x += particle.speed.x;\r\n            particle.y += particle.speed.y;\r\n\r\n            context.beginPath();\r\n            context.fillStyle = particle.style;\r\n            context.arc( particle.x, particle.y, particle.radius, 0, Math.PI * 2); // send particle at 360 degree\r\n            context.fill();\r\n        }\r\n    };\r\n\r\n    var drawSound = function () {\r\n        if (episodeIsPlaying) {\r\n            clearCanvas();\r\n            draw();\r\n\r\n            render.renderFrame(frequencyArray);\r\n\r\n            var k, i, value = 0;\r\n            energyCtx.strokeStyle = 'white';\r\n            energyCtx.shadowBlur = 100;\r\n            energyCtx.shadowColor = 'rgb(20, 20, 220)';\r\n\r\n            // FREQUENCY VARIABLE\r\n\r\n            var frenquencyLength = frequencyArray.length - 300;\r\n            var frenquencyOffset = ~~(frenquencyLength / frequencyCount);\r\n            var frequencyDraw = ~~(middleWidth / frequencyCount);\r\n            var drawing = -1;\r\n\r\n            // DOUBLE FREQUENCY ARC - SYMMETRIC\r\n\r\n            energyCtx.lineWidth = ~~(3 + Math.random() * 6);\r\n            energyCtx.beginPath();\r\n\r\n            k = 0;\r\n            for (i = frenquencyLength - frenquencyOffset; i >= 0; i -= frenquencyOffset) {\r\n                k++;\r\n                if (drawing > -1) {\r\n                    value = frequencyArray[i + 5] / 256;\r\n                    energyCtx.lineTo(k * frequencyDraw, energyHeight - middleHeight - (value * middleHeight));\r\n                } else if (frequencyArray[i + 5] / 256 > 0.1) {\r\n                    drawing = i;\r\n                    energyCtx.moveTo(k * frequencyDraw, middleHeight);\r\n                }\r\n            }\r\n\r\n            k = 0;\r\n            for (i = 0; i < frenquencyLength - frenquencyOffset * 2 - (frenquencyLength - drawing); i += frenquencyOffset) {\r\n                k++;\r\n                value = frequencyArray[i + 5] / 256;\r\n                energyCtx.lineTo(middleWidth + k * frequencyDraw, energyHeight - middleHeight - (value * middleHeight));\r\n            }\r\n            energyCtx.lineTo(middleWidth + k * frequencyDraw + frenquencyOffset, middleHeight);\r\n            energyCtx.stroke();\r\n\r\n            energyCtx.lineWidth = ~~(3 + Math.random() * 6);\r\n            energyCtx.beginPath();\r\n            energyCtx.moveTo(0, middleHeight);\r\n\r\n            k = 0;\r\n            drawing = -1;\r\n\r\n            for (i = frenquencyLength - frenquencyOffset; i >= 0; i -= frenquencyOffset) {\r\n                k++;\r\n                if (drawing > -1) {\r\n                    value = frequencyArray[i + 5] / 256;\r\n                    energyCtx.lineTo(k * frequencyDraw, energyHeight - middleHeight + (value * middleHeight));\r\n                } else if (frequencyArray[i + 5] / 256 > 0.1) {\r\n                    drawing = i;\r\n                    energyCtx.moveTo(k * frequencyDraw, middleHeight);\r\n                }\r\n            }\r\n\r\n            k = 0;\r\n            for (i = 0; i < frenquencyLength - frenquencyOffset * 2 - (frenquencyLength - drawing); i += frenquencyOffset) {\r\n                k++;\r\n                value = frequencyArray[i + 5] / 256;\r\n                energyCtx.lineTo(middleWidth + k * frequencyDraw, energyHeight - middleHeight + (value * middleHeight));\r\n            }\r\n\r\n            energyCtx.lineTo(middleWidth + k * frequencyDraw + frenquencyOffset, middleHeight);\r\n            energyCtx.stroke();\r\n\r\n        }\r\n    };\r\n    // clear canvas\r\n    var clearCanvas = function () {\r\n        context.clearRect(0, 0, width, height);\r\n        energyCtx.clearRect(0, 0, energyWidth, energyHeight);\r\n    };\r\n\r\n    try {\r\n        audioContext = new AudioContext();\r\n    } catch (ex) {\r\n        console.warn('Web Audio API is not supported in this browser');\r\n    }\r\n\r\n    for (var i = 0; i < 100; i++) {\r\n        particles.push(create_particle());\r\n    }\r\n\r\n\r\n    App.bind('episode-2', 'loaded', function () {\r\n        episodeIsPlaying = true;\r\n\r\n        setupAudioNodes();\r\n        video.currentTime = 0;\r\n        video.play();\r\n        ambientLight.play();\r\n\r\n        if (!render.isInitialized()) {\r\n            render.init({\r\n                // count: analyserNode.frequencyBinCount,\r\n                count: 10,\r\n                width: 360,\r\n                height: 360\r\n            });\r\n        }\r\n\r\n        // setup the event handler that is triggered every time enough samples have been collected\r\n        // trigger the audio analysis and draw the results\r\n        javascriptNode.addEventListener('audioprocess', function (e) {\r\n            var now = new Date().getTime();\r\n            if (lastDraw > now - frequency) return;\r\n            lastDraw = now;\r\n            // get the Time Domain data for this sample\r\n            // averageVolume = getAverageVolume(frequencyArray) / 100;\r\n            // analyserNode.getByteTimeDomainData(amplitudeArray);\r\n            analyserNode.getByteFrequencyData(frequencyArray);\r\n\r\n            // draw the display if the audio is playing\r\n            if (audioPlaying === true) {\r\n                window.requestAnimationFrame(drawSound);\r\n            }\r\n        });\r\n\r\n        // Load the Audio the first time through, otherwise play it from the buffer\r\n        if (audioData === null) {\r\n            loadSound(audioUrl);\r\n        } else {\r\n            playSound(audioData);\r\n        }\r\n\r\n    });\r\n\r\n    App.bind('episode-2', 'unloading', function () {\r\n        ambientLight.stop();\r\n        episodeIsPlaying = false;\r\n        sourceNode.stop(0);\r\n        audioPlaying = false;\r\n    });\r\n\r\n    App.bind('episode-2', 'unloaded', function () {\r\n        clearCanvas();\r\n        video.currentTime = 0;\r\n        video.pause();\r\n    });\r\n\r\n})();\r\n","\r\n(function () {\r\n\r\n    var GLOBAL_SPEED = 0.1,\r\n        HYPERSPACE_RUN = true;\r\n\r\n    App.bind('home', 'unloading', function () {\r\n        var interval = setInterval(function () {\r\n            GLOBAL_SPEED = (GLOBAL_SPEED + 0.1) * 1.3;\r\n            if (GLOBAL_SPEED > 70) {\r\n                clearInterval(interval);\r\n            }\r\n        }, 100);\r\n\r\n        var home = $('.page.home'),\r\n            select = $('.page.select');\r\n\r\n        // select.addEventListener('animationend', function begin(e) { \r\n        //     select.removeEventListener('animationend', begin);\r\n        // });\r\n\r\n        home.classList.add('exit-hyperspace');\r\n        select.classList.add('enter-hyperspace');\r\n    });\r\n\r\n    App.bind('home', 'unloaded', function () {\r\n        HYPERSPACE_RUN = false;\r\n\r\n        var home = $('.page.home'),\r\n            select = $('.page.select');\r\n\r\n        home.classList.remove('visible');\r\n        home.classList.remove('exit-hyperspace');\r\n        select.classList.remove('enter-hyperspace');\r\n    });\r\n\r\n    (function (canvas) {\r\n\r\n        canvas.width = window.innerWidth;\r\n        canvas.height = window.innerHeight;\r\n\r\n        if (canvas.getContext) {\r\n            var context = canvas.getContext('2d'),\r\n                width = canvas.width,\r\n                height = canvas.height,\r\n                starsCount = 100,\r\n                centerRadius = 100,\r\n                length = 10,\r\n                stars = [];\r\n\r\n            var createStar = function () {\r\n                var randomX = Math.random(),\r\n                    randomY = Math.random(),\r\n                    color = ~~(Math.random() * 80 + 20);\r\n\r\n                return {\r\n                    x: randomX * width,\r\n                    y: randomY * height,\r\n                    xs: (randomX * width - width/2) / 500,\r\n                    ys: (randomY * height - height/2) / 500,\r\n                    size: ~~(color / 20),\r\n                    length: Math.random() * length,\r\n                    color: 'rgb(' + color + ', ' + color + ', ' + ~~(color + Math.random() * 20) + ')'\r\n                };\r\n            };\r\n\r\n            for (var i = 0; i < starsCount; i++) {\r\n                stars.push(createStar());\r\n            }\r\n\r\n            (function loop() {\r\n                if (HYPERSPACE_RUN) {\r\n\r\n                    window.requestAnimationFrame(loop);\r\n                    context.clearRect(0, 0, width, height);\r\n\r\n                    for (var i = 0; i < starsCount; i++) {\r\n                        var s = stars[i];\r\n                        if (s.x < 0 || s.y < 0 || s.x > width || s.y > height) {\r\n                            s = stars[i] = createStar();\r\n                        }\r\n                        context.strokeStyle = s.color;\r\n                        context.lineWidth = s.size;\r\n                        context.shadowBlur = 5;\r\n                        context.lineCap = 'round';\r\n                        context.shadowColor = \"#555\";\r\n                        context.beginPath();\r\n                        context.moveTo(s.x, s.y);\r\n                        context.lineTo(s.x + 0.1 + s.length * s.xs * GLOBAL_SPEED, s.y + s.length * s.ys * GLOBAL_SPEED);\r\n                        context.stroke();\r\n                        s.x += s.xs * GLOBAL_SPEED;\r\n                        s.y += s.ys * GLOBAL_SPEED;\r\n                    }\r\n                }\r\n            })();\r\n        }\r\n\r\n    })($('.hyperspace'));\r\n\r\n})();","\r\n(function () {\r\n\r\n    var preloadImages = function (urls) {\r\n        for (var i = urls.length - 1; i >= 0; i--) {\r\n            var img = new Image();\r\n            img.src = urls[i];\r\n        }\r\n    };\r\n\r\n    App.init = function () {\r\n\r\n        preloadImages([\r\n            'img/film-1.jpg',\r\n            'img/film-2.jpg',\r\n            'img/film-3.jpg',\r\n            'img/film-4.jpg',\r\n            'img/film-5.jpg',\r\n            'img/film-6.jpg',\r\n            'img/film-7.jpg',\r\n            'img/lock.svg',\r\n            'img/star-wars-logo.svg',\r\n            'img/starship-left.png',\r\n            'img/starship-right.png',\r\n            'img/vote-left.jpg',\r\n            'img/vote-right.jpg',\r\n        ]);\r\n\r\n        window.addEventListener('load', function () {\r\n            var loader = $('section.loader');\r\n            if (loader) {\r\n                loader.addEventListener('transitionend', function () {\r\n                    loader.classList.remove('visible', 'fade-out');\r\n                });\r\n                loader.classList.add('fade-out');\r\n            }\r\n            if (window.location.hash && window.location.hash.length > 2) {\r\n                var hash = window.location.hash.substring(2),\r\n                    page = $('.page.' + hash);\r\n\r\n                if (page && page.classList.contains('page')) {\r\n                    page.classList.add('visible');\r\n                    App.call(hash, 'loading');\r\n                    App.call(hash, 'loaded');\r\n                    return;\r\n                }\r\n            }\r\n            $('.page.home').classList.add('visible');\r\n            App.call('home', 'loading');\r\n            App.call('home', 'loaded');\r\n        });\r\n\r\n    };\r\n\r\n})();\r\n","/**\r\n * Navigation between pages\r\n *\r\n */\r\n\r\n(function () {\r\n\r\n    // Bind begin button to hyperspace animation\r\n    $('.begin').addEventListener('click', function (e) {\r\n        App.call('home', 'unloading');\r\n        App.call('select', 'loading');\r\n        var select = $('.page.select');\r\n        select.addEventListener('animationend', function begin(e) { \r\n            select.removeEventListener('animationend', begin);\r\n            App.call('home', 'unloaded');\r\n            App.call('select', 'loaded');\r\n            $('.page.select').classList.add('visible');\r\n            App.setLocation('select');\r\n        });\r\n    });\r\n\r\n    // Bind navigation elements to animations\r\n    var bindNavigation = function (element) {\r\n        element.addEventListener('click', function (e) {\r\n            if (this.getAttribute('data-target')) {\r\n                App.goto(this.getAttribute('data-target'), this.getAttribute('data-direction') === 'up');\r\n            }\r\n            e.preventDefault();\r\n        });\r\n    };\r\n\r\n    var elements = $$('.navigation');\r\n    for (var i = elements.length - 1; i >= 0; i--) {\r\n        bindNavigation(elements[i]);\r\n    }\r\n\r\n    // Change page if hash change\r\n    window.addEventListener('hashchange', App.gotoHash);\r\n\r\n})();\r\n","/**\r\n * Episode selection\r\n *\r\n */\r\n\r\n(function () {\r\n\r\n    var select = {\r\n        lastMove: 0,\r\n        leftOffset: window.screen.width / 2 - 100,\r\n        rightOffset: 0,\r\n        screenScale: (100 - 100 / 1.75),\r\n        selectCards: $('.select .cards')\r\n    };\r\n\r\n    select.percentDivisor = window.screen.width - select.rightOffset - select.leftOffset;\r\n\r\n    var selectionListener = function(event) {\r\n        var now = new Date().getTime();\r\n        if (select.lastMove < now - 20) {\r\n\r\n            select.lastMove = now;\r\n            var percent = (event.screenX - select.leftOffset) / select.percentDivisor;\r\n            \r\n            if (percent < 0) {\r\n                percent = 0;\r\n            } else if (percent > 1) {\r\n                percent = 1;\r\n            }\r\n\r\n            select.selectCards.style.transform = 'translateZ(0) translateX(-' + percent * select.screenScale + '%)';\r\n        }\r\n    };\r\n\r\n    App.bind('select', 'loading', function () {\r\n        document.addEventListener('mousemove', selectionListener);\r\n    });\r\n\r\n    App.bind('select', 'unloading', function () {\r\n        document.removeEventListener('mousemove', selectionListener);\r\n    });\r\n\r\n})();\r\n","\r\n(function () {\r\n\r\n    var buttons = $$('.button-vote');\r\n    var bindVote = function (elt) {\r\n        elt.addEventListener('click', function (e) {\r\n            for (var i = buttons.length - 1; i >= 0; i--) {\r\n                buttons[i].innerHTML = \"Je vote\";\r\n            }\r\n            elt.innerHTML = \"Vote validé !\";\r\n        });\r\n    };\r\n\r\n    for (var i = buttons.length - 1; i >= 0; i--) {\r\n        bindVote(buttons[i]);\r\n    }\r\n\r\n})();\r\n","\r\n// Load the page\r\nApp.init();\r\n\r\n// Everything is OK !\r\nconsole.log('Libs and App loaded !');\r\n"],"sourceRoot":"/source/"}